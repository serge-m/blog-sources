language: python
branches:
  only:
  - master
install:
- pip install pelican
script:
- declare -r SSH_FILE="$(mktemp -u $HOME/.ssh/deploy_blog_decrypted)"
- openssl aes-256-cbc -K $encrypted_d5bd62f799ff_key -iv $encrypted_d5bd62f799ff_iv -in ".travis/github_deploy_key.enc" -out "$SSH_FILE" -d
- chmod 600 "$SSH_FILE" && printf "%s\n" \
              "Host github.com" \
              "  IdentityFile $SSH_FILE" \
              "  LogLevel ERROR" >> ~/.ssh/config
- make dbg
- make publish
- make github

env:
  global:
